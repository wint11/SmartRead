# UI/UX 设计

## 设计理念
SmartRead 采用“内容优先”的设计理念。界面简洁、无干扰且高度响应，优先考虑阅读体验，同时保持管理工具易于访问但不喧宾夺主。

## 组件实现细节

### 1. 阅读器视图 (无限滚动)
位于 `src/components/reader-view.tsx`。
*   **架构**: 采用类似虚拟列表的自定义方案，结合手动 DOM 同步。
*   **状态**: 维护 `loadedChapters` 数组，包含上一章、当前章和下一章的内容。
*   **无限加载**:
    *   **向下加载**: 由底部的 `IntersectionObserver` 哨兵触发。追加内容到 `loadedChapters`。
    *   **向上加载**: 由顶部哨兵触发。向前插入内容到 `loadedChapters`。
*   **滚动同步**: 当向前插入章节时，浏览器的默认行为是跳到顶部。我们使用 `useLayoutEffect` 计算高度差 (`newScrollHeight - prevScrollHeight`) 并立即调整 `scrollTop`，从而创造无缝的“向上滚动”体验。

### 2. 主题系统
*   **Provider**: 使用 `next-themes` 提供商包裹应用。
*   **实现**: 在 `<html>` 标签上切换 `class` (dark/light/sepia)。
*   **Tailwind**: 组件使用 `dark:bg-zinc-950` 修饰符。“羊皮纸(Sepia)”主题通过自定义类覆盖背景和文本颜色的 CSS 变量来实现。

### 3. 幽灵模式 (故障特效)
*   **触发器**: `ReaderView` 中的隐藏计数器在点击标题时递增。当达到 5 次时，`isGhostMode` 状态变为 `true`。
*   **计时器逻辑**: `setInterval` 每 250ms 运行一次，检查 `new Date().getSeconds()`。
*   **时间裂缝**: 仅当秒数在 **42** 到 **45** 之间时渲染“传送门”按钮。这是前端逻辑中硬编码的时间窗口。

## 关键界面模块

### 1. 阅读器视图 (`/novel/[id]/chapter/[chapterId]`)
应用的核心部分。
*   **无限滚动**: 触底自动加载下一章。
*   **上下文菜单**: 默认隐藏，点击屏幕中央唤起。
*   **个性化**: 用户可调整字体大小、背景颜色（羊皮纸、深色、浅色）和行高。
*   **VIP 付费墙**: VIP 章节显示模糊遮罩和“解锁”按钮（这是 CTF 挑战的一部分）。

### 2. 作者工作台 (`/author`)
创作者的专属空间。
*   **数据表格**: 使用 `shadcn/ui` Table 组件展示小说列表及状态徽章。
*   **编辑器**: 用于撰写章节的富文本编辑器（支持 Markdown）。
*   **实时验证**: 表单使用 `zod` 模式验证，提供即时的错误反馈。

### 3. 管理后台 (`/admin`)
用于平台治理。
*   **仪表盘**: 概览指标（总用户数、日活用户）。
*   **审核队列**: 分屏界面，用于审核待发布章节，并高亮显示 AI 建议。

### 4. CTF 终端 (`/ctf`)
复古风格的黑客界面。
*   **视觉效果**: 等宽字体 (Fira Code)、CRT 扫描线效果、黑底绿字配色。
*   **交互**: 模仿 Linux Shell 的命令行界面。
*   **特效**: 解题成功时的“破碎”动画效果。

## 响应式策略
*   **移动优先**: 所有布局均优先针对移动屏幕构建，随后扩展适配平板和桌面。
*   **导航**:
    *   *桌面端*: 顶部水平导航栏。
    *   *移动端*: 底部标签栏或汉堡菜单用于次级操作。

## 用户流程
1.  **发现**: 首页轮播 -> 小说详情 -> 开始阅读。
2.  **创作**: 作者工作台 -> 创建小说 -> 添加章节 -> 提交审核。
3.  **黑客**: 发现线索 -> 进入 `/ctf` 或 `/hidden_directory` -> 解谜 -> 获取 Flag。
